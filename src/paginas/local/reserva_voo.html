<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Agendar</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <link rel="stylesheet" href="/src/assets/css/reserva_voo.css">
  <script src="/src/javascripts/local/buscar_voo.js"></script>
  <!--
  <img class="logo" src="/src/assets/images/aeropuc_logo.jpeg" alt="foto_logo">
  -->
</head>
<body>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
  <div id="nav-bar-local-pronta"></div>
  <script>
    // requisição para carregar o conteúdo do arquivo
    fetch('/src/agregados/navbar/nav_local.html') // se necessario, trocar o nome do arquivo aqui
        .then(response => response.text())
        .then(data => {
            
            var elemento = document.getElementById('nav-bar-local-pronta'); // trocar o nome do elemento

            // inserir o conteúdo HTML no elemento
            elemento.innerHTML = data;
        })
        .catch(error => console.error('Erro ao carregar o arquivo:', error));
  </script>

  <div id="cadastroCentral">
    <div style="margin:50px" id="containerDados">
      <form style="margin: 25px">
        <!-- cidade de chegada -->
        <label for="localDestino" class="form-label">Destino:</label>
        <select id="localDestino" name="localDestino" class="form-control">
          <option value="0">Selecionar</option>
          <option value="Aeroporto Internacional de Viracopos">Aeroporto Internacional de Viracopos</option>
          <option value="Aeroporto Internacional de São Paulo-Guarulhos">Aeroporto Internacional de São Paulo-Guarulhos</option>
          <option value="Aeroporto Internacional de Foz do Iguaçu/Cataratas">Aeroporto Internacional de Foz do Iguaçu/Cataratas</option>
          <option value="Aeroporto Internacional do Rio de Janeiro - Galeão">Aeroporto Internacional do Rio de Janeiro - Galeão</option>
          <option value="Aeroporto Internacional de Manaus Eduardo Gomes">Aeroporto Internacional de Manaus Eduardo Gomes</option>
          <option value="Aeroporto Internacional de Brasília">Aeroporto Internacional de Brasília</option>
          <option value="Aeroporto Internacional de Salvador - Deputado Luís Eduardo Magalhães">Aeroporto Internacional de Salvador - Deputado Luís Eduardo Magalhães</option>
          <option value="Aeroporto Internacional de Confins - Tancredo Neves">Aeroporto Internacional de Confins - Tancredo Neves</option>
          <option value="Aeroporto de Belo Horizonte/Pampulha-MG - Carlos Drummond de Andrade">Aeroporto de Belo Horizonte/Pampulha-MG - Carlos Drummond de Andrade</option>
          <option value="Aeroporto Internacional Afonso Pena">Aeroporto Internacional Afonso Pena</option>
          <option value="Aeroporto de São Paulo/Congonhas (CGH) – Deputado Freitas Nobre">Aeroporto de São Paulo/Congonhas (CGH) – Deputado Freitas Nobre</option>
          <option value="Aeroporto Santos Dumont">Aeroporto Santos Dumont</option>
          <option value="Aeroporto Internacional do Recife/Guararapes - Gilberto Freyre">Aeroporto Internacional do Recife/Guararapes - Gilberto Freyre</option>
          <option value="Aeroporto Internacional Porto Alegre Salgado Filho">Aeroporto Internacional Porto Alegre Salgado Filho</option>
          <option value="Aeroporto Internacional de Florianópolis - Hercílio Luz">Aeroporto Internacional de Florianópolis - Hercílio Luz</option>
          <option value="Aeroporto Internacional de Miami">Aeroporto Internacional de Miami</option>
          <option value="Aeroparque Jorge Newbery">Aeroparque Jorge Newbery</option>
          <option value="Aeroporto Internacional Pierre Elliott Trudeau">Aeroporto Internacional Pierre Elliott Trudeau</option>
          <option value="Arturo Merino Benitez International Airport">Arturo Merino Benitez International Airport</option>
          <option value="Aeroporto Internacional de Dallas/Fort Worth">Aeroporto Internacional de Dallas/Fort Worth</option>
          <option value="Aeroporto Internacional Benito Juárez">Aeroporto Internacional Benito Juárez</option>
          <option value="Aeroporto de Frankfurt">Aeroporto de Frankfurt</option>
          <option value="Aeroporto Internacional Indira Gandhi">Aeroporto Internacional Indira Gandhi</option>

          <script>
            // script de impressão de todas as origens possíveis
            fetch('http://localhost:3000/listarDestinos')
            .then(response => response.json())
            .then(data => {
                if (data.status === 'SUCCESS') {
                    const localPartidaSelect = document.getElementById('localDestino');

                    data.payload.forEach(rowData => {
                      // a consulta só retorna destino (SELECT destino FROM trajetos)
                      const option = document.createElement('option');
                      option.value = rowData[0]; // value do <select> para usar na outra busca
                      option.textContent = rowData[0]; // o que aparece no <select>

                      localPartidaSelect.appendChild(option);
                    });

                } else {
                    console.error(`Erro ao obter dados: ${data.message}`);
                }
            })
            .catch(error => console.error('Erro ao conectar:', error));

          </script>
        </select>

        <!-- cidade de partida -->
        <label for="localPartida" class="form-label">Partida:</label>
        <select id="localPartida" name="localPartida" class="form-control">
          <option value="0">Selecionar</option>
          <option value="Aeroporto Internacional de Viracopos">Aeroporto Internacional de Viracopos</option>
          <option value="Aeroporto Internacional de São Paulo-Guarulhos">Aeroporto Internacional de São Paulo-Guarulhos</option>
          <option value="Aeroporto Internacional de Foz do Iguaçu/Cataratas">Aeroporto Internacional de Foz do Iguaçu/Cataratas</option>
          <option value="Aeroporto Internacional do Rio de Janeiro - Galeão">Aeroporto Internacional do Rio de Janeiro - Galeão</option>
          <option value="Aeroporto Internacional de Manaus Eduardo Gomes">Aeroporto Internacional de Manaus Eduardo Gomes</option>
          <option value="Aeroporto Internacional de Brasília">Aeroporto Internacional de Brasília</option>
          <option value="Aeroporto Internacional de Salvador - Deputado Luís Eduardo Magalhães">Aeroporto Internacional de Salvador - Deputado Luís Eduardo Magalhães</option>
          <option value="Aeroporto Internacional de Confins - Tancredo Neves">Aeroporto Internacional de Confins - Tancredo Neves</option>
          <option value="Aeroporto de Belo Horizonte/Pampulha-MG - Carlos Drummond de Andrade">Aeroporto de Belo Horizonte/Pampulha-MG - Carlos Drummond de Andrade</option>
          <option value="Aeroporto Internacional Afonso Pena">Aeroporto Internacional Afonso Pena</option>
          <option value="Aeroporto de São Paulo/Congonhas (CGH) – Deputado Freitas Nobre">Aeroporto de São Paulo/Congonhas (CGH) – Deputado Freitas Nobre</option>
          <option value="Aeroporto Santos Dumont">Aeroporto Santos Dumont</option>
          <option value="Aeroporto Internacional do Recife/Guararapes - Gilberto Freyre">Aeroporto Internacional do Recife/Guararapes - Gilberto Freyre</option>
          <option value="Aeroporto Internacional Porto Alegre Salgado Filho">Aeroporto Internacional Porto Alegre Salgado Filho</option>
          <option value="Aeroporto Internacional de Florianópolis - Hercílio Luz">Aeroporto Internacional de Florianópolis - Hercílio Luz</option>
          <option value="Aeroporto Internacional de Miami">Aeroporto Internacional de Miami</option>
          <option value="Aeroparque Jorge Newbery">Aeroparque Jorge Newbery</option>
          <option value="Aeroporto Internacional Pierre Elliott Trudeau">Aeroporto Internacional Pierre Elliott Trudeau</option>
          <option value="Arturo Merino Benitez International Airport">Arturo Merino Benitez International Airport</option>
          <option value="Aeroporto Internacional de Dallas/Fort Worth">Aeroporto Internacional de Dallas/Fort Worth</option>
          <option value="Aeroporto Internacional Benito Juárez">Aeroporto Internacional Benito Juárez</option>
          <option value="Aeroporto de Frankfurt">Aeroporto de Frankfurt</option>
          <option value="Aeroporto Internacional Indira Gandhi">Aeroporto Internacional Indira Gandhi</option>
          
          <script>
            // script de impressão de todas as origens possíveis
            fetch('http://localhost:3000/listarPartida')
            .then(response => response.json())
            .then(data => {
                if (data.status === 'SUCCESS') {
                    const localPartidaSelect = document.getElementById('localPartida');

                    data.payload.forEach(rowData => {
                      // a consulta só retorna partida (SELECT origem FROM trajetos)
                      const option = document.createElement('option');
                      option.value = rowData[0]; // value do <select> para usar na outra busca
                      option.textContent = rowData[0]; // o que aparece no <select>

                      localPartidaSelect.appendChild(option);
                    });

                } else {
                    console.error(`Erro ao obter dados: ${data.message}`);
                }
            })
            .catch(error => console.error('Erro ao conectar:', error));

          </script>
        </select>

        <!-- div que é padrão desabilitada, onde tem todas as opções do escopo do projeto -->
        <div id="invisivelDiv">
      
          <!-- tipo de passagem -->
          <label for="tipoPassagem" class="form-label">Tipo de passagem:</label>
          <select id="tipoPassagem" name="tipoPassagem" onchange="conferirTipoViagem()" class="form-control">
            <option value="0">Selecionar</option>
            <option value="ambos">Ida e volta</option>
            <option value="ida">Somente ida</option>
          </select>

          <!-- data partida -->
          <label for="start" class="form-label">Data partida:</label>
          <input type="date" id="start" class="form-control" name="trip-start" value="2023-12-01" min="2023-11-01" max="2026-12-31"/>
          <!-- data volta (se o tipo de voo for IDA e VOLTA) -->
          <style>
            /* cria um estilo que deixa a div invisível */
            #talvez {
              display: none;
            }
          </style>
          <div id="talvez">
            <label for="back" class="form-label">Data volta:</label>
            <input type="date" id="back" class="form-control" name="trip-back" min="2023-12-01" max="2026-12-31"/>
          </div>
        </div>
        <div class="flexConteiner">
          <button type="button" id="btnProcurar" onclick="buscarVoos();">Buscar</button>
          <div class="form-check form-switch" style="margin-left: 20px; margin-top: 10px;">
            <input class="form-check-input" type="checkbox" role="switch" id="alterarOpcoesAvancadas" onclick="opcoesAvancadas();">
            <label class="form-check-label" for="alterarOpcoesAvancadas">Opções avançadas</label>
          </div>
        </div>
        <p id="status" style="margin-top: 8px;"></p>
      </form>
      <!-- aqui aparece a mensagem do resultado, a classe é selecionada no próprio javascript-->

    </div>
  </div>
  <div id="tabelaResultados">
    <h1 style="margin-top: 20px;">Escolher o voo</h1>
    <p class="lead" style="text-align: center;">Use as opções abaixo para escolher sua passagem.</p>
    <div class="tabela">
      <a type="button" class="btn btn-primary" style="margin: 10px;" href="/src/paginas/local/reserva_voo.html">Alterar busca</a>
      <table class="table table-light table-striped">
        <!-- thead da tabela (cabeçalho) -->
        <thead>
          <tr>
            <th scope="col">Ação</th>  
            <th scope="col">Data partida</th>
            <th scope="col">Trajeto</th>
            <th scope="col">Fabricante do avião</th>
            <th scope="col">Horário de partida</th>
            <th scope="col">Horário de chegada</th>
            <th scope="col">Valor</th>
          </tr>
        </thead>
        <!-- tbody da tabela (as informações) -->
        <tbody id="tabelaDeAeronaves" class="align-middle">
          <!-- As linhas da tabela serão adicionadas aqui via JavaScript -->
        </tbody>
      </table>
    </div>
  </div>
  <div class="container" style="margin-top:100px" id="mapaDeAssentos">
    <div id="mapaAssentos" class="mapaAssentos">
      <!-- aqui vem a impressão do mapa -->
    </div>
  </div>
</body>
</html>
